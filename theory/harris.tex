\section{Детектор Харриса}

Детектор Харриса (\textit{Harris Corner Detector}, 1988 год) - один из первых и самых популярных методов извлечения особенностей. Является детектором углов.

Определение углов - метод используемый в компьютерном зрении для извлечения особенностей. Угол, в общем случае, может быть определен как пересечение двух ребер, также угол может быть определен как точка, для которой есть два разных доминирующих направления градиента в локальной окрестности точки. Таким образом угол подходит под многие определения особенности и может быть использован в качестве ключевой точки. 

Метод основан на основном свойстве угла - выявлении доминирующих градиентов. Визуально его можно описать как сканирование изображения путём движения окна в локальной области какой-то точки и распознавание изменения яркости при различных сдвигах сразу в нескольких направлениях - характерная особенность угла.

Пусть $I$ - это изображение, $(x, y)$ - точка на нём, обозначающая центр окрестности некоторой точки. Для того чтобы измерить изменение окрестности, локальная область передвигается на $(\delta x, \delta y)$ и разница вычисляется по формуле:

\begin{equation}
    f(\delta x, \delta y) = \sum_{x, y} w(x, y) [I(x + \delta x, y + \delta y) - I(x, y)]^2
\end{equation}

Где $w(x, y)$ - функция веса для элемента суммы, чаще всего полагается равным нормальному распределению - чем ближе точка к центру окрестности, тем больший вклад она вносит, таким образом отбрасываются граничные значения. Получается что приближённое значение изменения яркости равно:

\begin{equation}
    f(\delta x, \delta y) \approx \begin{bmatrix} \delta x & \delta y \end{bmatrix} M \begin{bmatrix} \delta x \\ \delta y \end{bmatrix}
\end{equation}

Где матрица $M$ - интенсивность изображения вдоль осей $x$ и $y$ соответственно:

\begin{equation}
    M = \sum_{x, y} w(x, y) \begin{bmatrix} I_x^2 & I_x I_y \\ I_x I_y & I_x^2 \end{bmatrix}
\end{equation}

Далее вычисляются собственные значения результирующей матрицы, и далее в зависимости от их значений устанавливается является ли рассматриваемая точка особой. Если оба значения маленькие - значит что окрестность не меняется и точка не принадлежит углу. Если одно значение существенно больше другого, значит при движении в одном направлении окрестность сильно меняется, а при движении в другом - остаётся неизменной. Это значит что точка лежит на границе. В случае, когда оба собственных значения матрицы достаточно велики и примерно одинаковы, можно говорить что точка образует угол.

\vspace{1mm}
Алгоритм детектора следующий:

\begin{enumerate}
    \item Вычислить градиент изображения в каждом пикселе;
    \item Вычислить матрицу $M$ для каждого пикселя в локальной окрестности;
    \item Вычислить собственные значения матрицы $M$;
    \item Отбросить точки не проходящие пороговые значения;
    \item Найти локальные максимумы функции отклика в заданной окрестности;
    \item Выбрать $N$ самых сильных локальных максимумов.
\end{enumerate}

Детектор Харриса является инвариантным к изменению угла поворота, но не инвариантен к изменению масштаба. Это проблему решают детекторы, которые будут рассмотрены далее.